//index.html

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Vehicle Dashboard</title>

<!-- ----------------------------------------------------------
     DASHBOARD STYLES
     Dark, automotive-inspired UI for live telemetry display
----------------------------------------------------------- -->
<style>
/* ------------------------------
   GLOBAL THEME
------------------------------ */
:root {
    --bg-main: #020617;
    --bg-card: #030712;
    --border-soft: #1f2937;
    --text-main: #e5e7eb;
    --text-muted: #94a3b8;

    --ok:   #22c55e;
    --warn: #f59e0b;
    --bad:  #ef4444;
}

* {
    box-sizing: border-box;
}

body {
    margin: 0;
    font-family: "Inter", "Segoe UI", system-ui, sans-serif;
    background:
        radial-gradient(circle at 50% -20%, #020617 30%, #000 70%);
    color: var(--text-main);
    min-height: 100vh;
}

/* ------------------------------
   HEADER
------------------------------ */
header {
    padding: 18px 28px;
    font-size: 1.5rem;
    font-weight: 700;
    letter-spacing: 0.12em;
    background: linear-gradient(to right, #020617, #020617ee);
    border-bottom: 1px solid var(--border-soft);
    text-transform: uppercase;
}

/* ------------------------------
   DASHBOARD GRID
------------------------------ */
.dashboard {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 22px;
    padding: 28px;
}

/* ------------------------------
   TELEMETRY CARD
------------------------------ */
.card {
    position: relative;
    background:
        linear-gradient(180deg, #030712, #020617);
    border-radius: 16px;
    padding: 22px 20px 20px;
    border: 1px solid #0f172a;
    box-shadow:
        0 10px 30px rgba(0,0,0,0.6),
        inset 0 1px 0 rgba(255,255,255,0.02);
    transition:
        transform 0.25s ease,
        box-shadow 0.25s ease,
        border-color 0.25s ease;
}

/* subtle “panel lift” */
.card:hover {
    transform: translateY(-6px);
    border-color: #1e293b;
    box-shadow:
        0 18px 45px rgba(0,0,0,0.8),
        0 0 28px rgba(56,189,248,0.08);
}

/* ------------------------------
   CARD TEXT
------------------------------ */
.label {
    font-size: 0.75rem;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 6px;
}

.value {
    font-size: 3rem;
    font-weight: 800;
    line-height: 1;
    margin: 6px 0 4px;
    font-variant-numeric: tabular-nums;
}

.unit {
    font-size: 0.9rem;
    color: var(--text-muted);
}

/* ------------------------------
   STATUS COLORS (USED BY JS)
------------------------------ */
.ok {
    color: var(--ok);
    text-shadow: 0 0 12px rgba(34,197,94,0.25);
}

.warn {
    color: var(--warn);
    text-shadow: 0 0 12px rgba(245,158,11,0.25);
}

.bad {
    color: var(--bad);
    text-shadow: 0 0 14px rgba(239,68,68,0.35);
}

/* ------------------------------
   FOOTER
------------------------------ */
.footer {
    text-align: center;
    font-size: 0.8rem;
    color: #64748b;
    padding-bottom: 18px;
    letter-spacing: 0.08em;
    text-transform: uppercase;
}

/* ------------------------------
   RESPONSIVE TWEAK
------------------------------ */
@media (max-width: 600px) {
    .value {
        font-size: 2.4rem;
    }
}
</style>

</head>

<body>

<!-- ----------------------------------------------------------
     HEADER
----------------------------------------------------------- -->
<header>DASHBOARD</header>

<!-- ----------------------------------------------------------
     TELEMETRY CARDS
     Values populated dynamically via JavaScript
----------------------------------------------------------- -->
<div class="dashboard">

    <div class="card">
        <div class="label">Motor RPM</div>
        <div class="value" id="rpm">---</div>
        <div class="unit">rpm</div>
    </div>

    <div class="card">
        <div class="label">Vehicle Speed</div>
        <div class="value" id="speed">---</div>
        <div class="unit">km/h</div>
    </div>

    <div class="card">
        <div class="label">Battery SOC</div>
        <div class="value" id="soc">---</div>
        <div class="unit">%</div>
    </div>

    <div class="card">
        <div class="label">Battery Voltage</div>
        <div class="value" id="voltage">---</div>
        <div class="unit">V</div>
    </div>

    <div class="card">
        <div class="label">Motor Temperature</div>
        <div class="value" id="temp">---</div>
        <div class="unit">°C</div>
    </div>

</div>

<div class="footer">Live CAN data • Local backend</div>

<!-- ----------------------------------------------------------
     DATA FETCH & UI UPDATE LOGIC
----------------------------------------------------------- -->
<script>
/**
 * Apply visual status based on signal limits.
 */
function applyStatus(el, value, min, max) {
    el.classList.remove("ok", "warn", "bad");

    if (value < min || value > max) {
        el.classList.add("bad");
    } else if (value > max * 0.9) {
        el.classList.add("warn");
    } else {
        el.classList.add("ok");
    }
}

/**
 * Fetch decoded CAN data from backend and update UI.
 */
async function update() {
    try {
        const r = await fetch("http://127.0.0.1:8080/data");
        const d = await r.json();

        const rpm  = document.getElementById("rpm");
        const spd  = document.getElementById("speed");
        const soc  = document.getElementById("soc");
        const volt = document.getElementById("voltage");
        const temp = document.getElementById("temp");

        rpm.textContent  = d.motor_rpm.toFixed(0);
        spd.textContent  = d.vehicle_speed.toFixed(1);
        soc.textContent  = d.battery_soc.toFixed(0);
        volt.textContent = d.battery_voltage.toFixed(2);
        temp.textContent = d.motor_temperature.toFixed(1);

        applyStatus(rpm,  d.motor_rpm,          0, 8000);
        applyStatus(spd,  d.vehicle_speed,      0, 120);
        applyStatus(soc,  d.battery_soc,       20, 100);
        applyStatus(volt, d.battery_voltage,   40, 60);
        applyStatus(temp, d.motor_temperature,  0, 90);

    } catch (e) {
        console.error("Fetch failed", e);
    }
}

/* Periodic polling */
setInterval(update, 500);
update();
</script>

</body>
</html>
